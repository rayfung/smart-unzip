#!/usr/bin/python

import sys
import os

from_encoding='GB18030'
to_encoding='UTF-8'
if len(sys.argv) < 3:
	sys.exit(1)
op=sys.argv[1]
for oldfile in sys.argv[2:]:
	try:
		newfile=oldfile.decode(from_encoding).encode(to_encoding)
	except UnicodeDecodeError:
		sys.exit(1)
	if op == 'notest':
		os.rename(oldfile, newfile)
sys.exit(0)
